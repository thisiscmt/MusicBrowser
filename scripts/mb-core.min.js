/*! music-browser 06-02-2016 04: */

firstBy=function(){function a(a){return a.thenBy=b,a}function b(b){var c=this;return a(function(a,d){return c(a,d)||b(a,d)})}return a}();var musicBrowserApp=angular.module("MusicBrowserApp",["ngRoute","ngSanitize","ui.bootstrap","jmdobry.angular-cache","pasvaz.bindonce","musicBrowserControllers"]),musicBrowserControllers=angular.module("musicBrowserControllers",[]);musicBrowserApp.config(["$routeProvider","$provide",function(a,b){a.when("/",{templateUrl:"views/search.html",controller:"SearchCtrl",title:"Search"}),a.when("/search",{templateUrl:"views/search.html",controller:"SearchCtrl",title:"Search"}),a.when("/search/artist/:searchTerm",{templateUrl:"views/artistSearch.html",controller:"ArtistSearchCtrl",title:"Artist Search"}),a.when("/search/album/:searchTerm",{templateUrl:"views/albumSearch.html",controller:"AlbumSearchCtrl",title:"Album Search"}),a.when("/search/song/:searchTerm",{templateUrl:"views/songSearch.html",controller:"SongSearchCtrl",title:"Song Search"}),a.when("/artist/:id",{templateUrl:"views/artist.html",controller:"ArtistLookupCtrl",title:"Artist"}),a.when("/artist/:id/full-bio",{templateUrl:"views/artistBio.html",controller:"ArtistLookupCtrl",title:"Artist Bio"}),a.when("/artist/:id/full-discog",{templateUrl:"views/discog.html",controller:"ArtistLookupCtrl",title:"Artist Discography"}),a.when("/album/:id",{templateUrl:"views/album.html",controller:"AlbumLookupCtrl",title:"Album"}),a.when("/album/:id/full-review",{templateUrl:"views/albumReview.html",controller:"AlbumLookupCtrl",title:"Album Review"}),a.when("/style/:id",{templateUrl:"views/style.html",controller:"StyleLookupCtrl",title:"Style"}),a.when("/genre/:id",{templateUrl:"views/genre.html",controller:"GenreLookupCtrl",title:"Genre"}),a.when("/options",{templateUrl:"views/options.html",controller:"OptionsCtrl",title:"Options"}),a.otherwise({redirectTo:"/"})}]),musicBrowserApp.run(["$rootScope","$http","$angularCacheFactory",function(a,b,c){a.title="Search",c("dataCache",{maxAge:36e5,cacheFlushInterval:12e6,deleteOnExpire:"aggressive"}),b.defaults.cache=c.get("dataCache")}]),musicBrowserApp.factory("mbCommon",["$window","$uibModal","$rootScope",function(a,b,c){var d=this,e=null;return Object.defineProperty(d,"placeholderImageSmall",{value:"images/Placeholder_25.png",writable:!1,enumerable:!0,configurable:!0}),Object.defineProperty(d,"placeholderImageMedium",{value:"images/Placeholder_50.png",writable:!1,enumerable:!0,configurable:!0}),Object.defineProperty(d,"placeholderImageLarge",{value:"images/Placeholder_90.png",writable:!1,enumerable:!0,configurable:!0}),Object.defineProperty(d,"currentArtist",{value:"",writable:!0,enumerable:!0,configurable:!0}),Object.defineProperty(d,"currentAlbum",{value:"",writable:!0,enumerable:!0,configurable:!0}),Object.defineProperty(d,"currentStyle",{value:"",writable:!0,enumerable:!0,configurable:!0}),Object.defineProperty(d,"currentGenre",{value:"",writable:!0,enumerable:!0,configurable:!0}),d.showLoadingDialog=function(a){e=b.open({templateUrl:"views/loadingDialog.html",controller:"ModalCtrl",keyboard:!1,resolve:{loadingMsg:function(){return a}}})},d.closeLoadingDialog=function(){e&&e.close()},d.setPageTitle=function(a){c.title=a},d.goBack=function(){a.history.back()},d.sortArray=function(a){var b=1;return"-"===a[0]&&(b=-1,a=a.substr(1)),function(c,d){var e=c[a]<d[a]?-1:c[a]>d[a]?1:0;return e*b}},d.shorten=function(a,b){a.length>b},d.formatDate=function(a,b,c){var d="";if(a&&""!=a){var e=a.replace(/-\?\?/g,""),f=e.split("-");d=1===f.length?f[0]:b?f[0]:2===f.length?c?moment(f[1]+"/1/"+f[0]).format("MMMM, YYYY"):moment(f[1]+"/1/"+f[0]).format("M/YYYY"):c?moment(f[1]+"/"+f[2]+"/"+f[0]).format("MMMM D, YYYY"):moment(e).format("M/D/YYYY")}return d},d.formatDuration=function(a){var b,c,d="",e="",f="",g="";return 0===a?d="0:0":60>a?d="0:"+a:(b=Math.floor(a/60),c=a%60,b>59&&(g=Math.floor(b/60)+":",b%=60),f=10>b&&""!=g?"0"+b:b,e=10>c?":0"+c:":"+c,d=g+f+e),d},d.formatError=function(a){var b,c;if(a.responseText&&""!=a.responseText)try{b=JSON.parse(a.responseText),c=b.Message?""!=b.ExceptionMessage?b.ExceptionMessage:b.Message:b.error}catch(d){c=a.responseText}else a.data?(a.status&&(c="HTTP status "+a.status+": "),c+=a.data):c=a.message?a.message:a;return c},d.getConfiguration=function(){var a,b=localStorage.getItem("MBConfig");return a=b?JSON.parse(b):{},a.albumChrono||(a.albumChrono=!1),a.pageSize||(a.pageSize=20),a},d.setConfiguration=function(a){localStorage.setItem("MBConfig",JSON.stringify(a))},d.isMobile=function(){return/Mobi/.test(navigator.userAgent)?!0:!1},d}]),musicBrowserApp.factory("mbData",["mbCommon","$http","$angularCacheFactory",function(a,b,c){var d=this,e=20;Object.defineProperty(d,"maxShortDescriptionLength",{value:150,writable:!1,enumerable:!0,configurable:!0}),d.searchForArtist=function(c,d,e){var g="api/search/artist/"+encodeURIComponent(c)+"?size="+d+"&offset="+e;return b.get(g,{cache:!0}).then(function(b){var c=JSON.parse(b.data.Content),d={};return c.searchResponse&&(d.data=c.searchResponse.results.map(function(b){return f(b,a.placeholderImageMedium),b})),d},function(b){return{error:a.formatError(b)}})},d.lookupArtist=function(c){var d="api/artist/"+encodeURIComponent(c);return b.get(d,{cache:!0}).then(function(b){var c,d,j,k=JSON.parse(b.data.Content),l=a.getConfiguration(),m=0;if(k.name.musicGenres)for(var n=0;n<k.name.musicGenres.length;n++)j=i(k.name.musicStyles,k.name.musicGenres[n].id),j>-1&&k.name.musicStyles.splice(j,1);if(k.name.isGroup?(k.name.originLabel="Formed:",k.name.endLabel="Disbanded:"):(k.name.originLabel="Born:",k.name.endLabel="Died:"),k.name.active)for(var n=0;n<k.name.active.length;n++)k.name.active[n]=a.formatDate(k.name.active[n],!0);if(k.name.birth){var o=a.formatDate(k.name.birth.date,!1,!0);""===o?k.name.birth.date="N/A":k.name.birth.date=o}if(k.name.death){var o=a.formatDate(k.name.death.date,!1,!0);""!=o&&(k.name.death.date=o)}if(f(k,a.placeholderImageLarge),k.name.musicBio&&(d=g(k.name.musicBio.text),d=d.split("\r\n").join("<br /><br />"),k.name.musicBioFormatted=d),k.name.headlineBio?k.name.headlineBioFormatted=g(k.name.headlineBio):k.name.musicBio&&(k.name.headlineBioFormatted=h(k.name.musicBioFormatted)),k.name.shortDiscog=[],k.name.discography){l.albumChrono&&k.name.discography.reverse();for(var n=0;n<k.name.discography.length;n++)k.name.discography[n].year?k.name.discography[n].year=a.formatDate(k.name.discography[n].year,!0):k.name.discography[n].year="N/A",c=k.name.discography[n].images&&k.name.discography[n].images.length>0?k.name.discography[n].images[0].url:a.placeholderImageSmall,k.name.discography[n].primaryImage=c,k.name.discography[n].flags&&k.name.discography[n].flags.indexOf("Compilation")>-1?(k.name.discography[n].formattedType="Compilation",k.name.hasFullDiscog=!0):"Single"===k.name.discography[n].type||"EP"===k.name.discography[n].type?(k.name.discography[n].formattedType="SingleOrEP",k.name.hasFullDiscog=!0):(k.name.discography[n].formattedType="Album",k.name.shortDiscog.length<e&&k.name.shortDiscog.push(k.name.discography[n]),m++),k.name.discography[n].ids&&!k.name.discography[n].ids.albumId&&k.name.discography[n].ids.amgPopId&&(k.name.discography[n].ids.albumId=k.name.discography[n].ids.amgPopId);m>e&&(k.name.hasFullDiscog=!0)}if(k.name.metaItems=[],k.name.groupMembers){for(var n=0;n<k.name.groupMembers.length;n++)k.name.groupMembers[n].formattedType="Member",k.name.groupMembers[n].primaryImage=a.placeholderImageSmall;k.name.metaItems.push.apply(k.name.metaItems,k.name.groupMembers)}if(k.name.similars){k.name.similars.sort(firstBy(function(a,b){return b.weight-a.weight}).thenBy(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0}));for(var n=0;n<k.name.similars.length;n++)k.name.similars[n].formattedType="RelatedArtist",k.name.similars[n].primaryImage=a.placeholderImageSmall;k.name.metaItems.push.apply(k.name.metaItems,k.name.similars)}return{data:k.name}},function(b){return{error:a.formatError(b)}})},d.searchForAlbum=function(c,d,e){var f="api/search/album/"+encodeURIComponent(c)+"?size="+d+"&offset="+e;return b.get(f,{cache:!0}).then(function(b){var c=JSON.parse(b.data.Content),d={};return c.searchResponse&&(d.data=c.searchResponse.results.map(function(b){return b.album.images&&b.album.images.length>0?b.album.primaryImage=b.album.images[0].url:b.album.primaryImage=a.placeholderImageMedium,b})),d},function(b){return{error:a.formatError(b)}})},d.lookupAlbum=function(c){var d="api/album/"+encodeURIComponent(c);return b.get(d,{cache:!0}).then(function(b){var c,d,e=JSON.parse(b.data.Content);if(e.album.originalReleaseDate&&(e.album.originalReleaseDate=a.formatDate(e.album.originalReleaseDate,!1,!0)),e.album.duration&&(e.album.durationFormatted=a.formatDuration(e.album.duration)),c=e.album.images&&e.album.images.length>0?e.album.images[0].url:a.placeholderImageLarge,e.album.primaryImage=c,e.album.primaryReview&&(d=g(e.album.primaryReview.text),formattedBioText=d.split("\r\n").join("<br /><br />"),e.album.primaryReviewFormatted=d),e.album.headlineReview?e.album.headlineReviewFormatted=g(e.album.headlineReview.text):e.album.primaryReview&&(e.album.headlineReviewFormatted=h(e.album.primaryReviewFormatted)),e.album.tracks&&e.album.tracks.length>0)for(var f=0;f<e.album.tracks.length;f++)e.album.tracks[f].durationFormatted=a.formatDuration(e.album.tracks[f].duration);return{data:e.album}},function(b){return{error:a.formatError(b)}})},d.searchForSong=function(c,d,e){var f="api/search/song/"+encodeURIComponent(c)+"?size="+d+"&offset="+e;return b.get(f,{cache:!0}).then(function(b){var c=JSON.parse(b.data.Content),d={};return c.searchResponse&&(d.data=c.searchResponse.results.map(function(b){return b.song.images&&b.song.images.length>0?b.song.primaryImage=b.song.images[0].url:b.song.primaryImage=a.placeholderImageMedium,b})),d},function(b){return{error:a.formatError(b)}})},d.lookupStyle=function(c){var d="api/style/"+encodeURIComponent(c);return b.get(d,{cache:!0}).then(function(a){var b,c=JSON.parse(a.data.Content),d={};return b=c.styles?c.styles:c.subgenres,d.data=b.map(function(a){return a.formattedDescription=g(a.description),a}),d},function(b){return{error:a.formatError(b)}})},d.lookupGenre=function(c){var d="api/genre/"+encodeURIComponent(c);return b.get(d,{cache:!0}).then(function(a){var b=JSON.parse(a.data.Content),c={};return c.data=b.genres.map(function(a){return a.formattedDescription=g(a.description),a}),c},function(b){return{error:a.formatError(b)}})},d.isCached=function(a){var b=!1;return c.get("dataCache").get("api"+a)&&(b=!0),b};var f=function(a,b){if(a.name)if(a.name.images&&a.name.images.length>0){for(var c=0;c<a.name.images.length;c++)if(-1===a.name.images[c].url.indexOf("Getty")){a.name.primaryImage=a.name.images[c].url;break}c===a.name.images.length&&(a.name.primaryImage=b)}else a.name.primaryImage=b},g=function(a){for(var b,c,d,e,f,g,h,i,j,k,l=!1;!l;)b=a.indexOf("[roviLink"),-1===b?l=!0:(c=a.indexOf("]",b),g=JSON.parse(a.substring(b+10,c)),d=a.indexOf("[/roviLink]"),h=g.substr(0,2),k="MN"===h&&g.length>2?"#artist/"+g:"MW"===h&&g.length>2?"#album/"+g:"",i=a.substring(c+1,d),j=""===k?i:"<a href='"+k+"'>"+i+"</a>",e=a.indexOf("]",d),f=a.substring(b,e+1),a=a.replace(f,j));for(l=!1;!l;)b=a.indexOf("[muze"),-1===b?l=!0:(e=a.indexOf("]",b),f=a.substring(b,e+1),a=a.replace(f,""),b=a.indexOf("[/muze"),e=a.indexOf("]",b),f=a.substring(b,e+1),a=a.replace(f,""));return a},h=function(a){var b,c,e,f,g,h;if(a.replace(/\<[^\>]*\>/gi,"").length<=d.maxShortDescriptionLength)return a;for(e=!1,b=0,c=0,f=!0;!e;)"<a"===a.substr(b,2)?(f=!1,g=!0,b+=2):"'>"===a.substr(b,2)?(f=!0,b+=2):"</a>"===a.substr(b,4)?(g=!1,b+=4):(f&&c++,c===d.maxShortDescriptionLength?e=!0:b++);for(e=!1;!e;)if(" "===a[b]||"\r"===a[b]){if(g)for(h=!1;!h;)"</a>"===a.substr(b,4)?(h=!0,b+=4):b++;e=!0}else b++;return a.substr(0,b)+" ..."},i=function(a,b){for(var c=-1,d=0;d<a.length;d++)if(a[d].id===b){c=d;break}return c};return d}]),function(){"use strict";var a=angular.module("pasvaz.bindonce",[]);a.directive("bindonce",function(){var a=function(a){if(a&&0!==a.length){var b=angular.lowercase(""+a);a=!("f"===b||"0"===b||"false"===b||"no"===b||"n"===b||"[]"===b)}else a=!1;return a},b=parseInt((/msie (\d+)/.exec(angular.lowercase(navigator.userAgent))||[])[1],10);isNaN(b)&&(b=parseInt((/trident\/.*; rv:(\d+)/.exec(angular.lowercase(navigator.userAgent))||[])[1],10));var c={restrict:"AM",controller:["$scope","$element","$attrs","$interpolate",function(c,d,e,f){var g=function(b,c,d){var e="show"===c?"":"none",f="hide"===c?"":"none";b.css("display",a(d)?e:f)},h=function(a,b){if(angular.isObject(b)&&!angular.isArray(b)){var c=[];angular.forEach(b,function(a,b){a&&c.push(b)}),b=c}b&&a.addClass(angular.isArray(b)?b.join(" "):b)},i=function(a,b){a.transclude(b,function(b){var c=a.element.parent(),d=a.element&&a.element[a.element.length-1],e=c&&c[0]||d&&d.parentNode,f=d&&d.nextSibling||null;angular.forEach(b,function(a){e.insertBefore(a,f)})})},j={watcherRemover:void 0,binders:[],group:e.boName,element:d,ran:!1,addBinder:function(a){this.binders.push(a),this.ran&&this.runBinders()},setupWatcher:function(a){var b=this;this.watcherRemover=c.$watch(a,function(a){void 0!==a&&(b.removeWatcher(),b.checkBindonce(a))},!0)},checkBindonce:function(a){var b=this,c=a.$promise?a.$promise.then:a.then;"function"==typeof c?c(function(){b.runBinders()}):b.runBinders()},removeWatcher:function(){void 0!==this.watcherRemover&&(this.watcherRemover(),this.watcherRemover=void 0)},runBinders:function(){for(;this.binders.length>0;){var c=this.binders.shift();if(!this.group||this.group==c.group){var d=c.scope.$eval(c.interpolate?f(c.value):c.value);switch(c.attr){case"boIf":a(d)&&i(c,c.scope.$new());break;case"boSwitch":var e,j=c.controller[0];(e=j.cases["!"+d]||j.cases["?"])&&(c.scope.$eval(c.attrs.change),angular.forEach(e,function(a){i(a,c.scope.$new())}));break;case"boSwitchWhen":var k=c.controller[0];k.cases["!"+c.attrs.boSwitchWhen]=k.cases["!"+c.attrs.boSwitchWhen]||[],k.cases["!"+c.attrs.boSwitchWhen].push({transclude:c.transclude,element:c.element});break;case"boSwitchDefault":var k=c.controller[0];k.cases["?"]=k.cases["?"]||[],k.cases["?"].push({transclude:c.transclude,element:c.element});break;case"hide":case"show":g(c.element,c.attr,d);break;case"class":h(c.element,d);break;case"text":c.element.text(d);break;case"html":c.element.html(d);break;case"style":c.element.css(d);break;case"disabled":c.element.prop("disabled",d);break;case"src":c.element.attr(c.attr,d),b&&c.element.prop("src",d);break;case"attr":angular.forEach(c.attrs,function(a,b){var d,e;b.match(/^boAttr./)&&c.attrs[b]&&(d=b.replace(/^boAttr/,"").replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),e=c.scope.$eval(c.attrs[b]),c.element.attr(d,e))});break;case"href":case"alt":case"title":case"id":case"value":c.element.attr(c.attr,d)}}}this.ran=!0}};angular.extend(this,j)}],link:function(a,b,c,d){var e=c.bindonce&&a.$eval(c.bindonce);void 0!==e?d.checkBindonce(e):(d.setupWatcher(c.bindonce),b.bind("$destroy",d.removeWatcher))}};return c}),angular.forEach([{directiveName:"boShow",attribute:"show"},{directiveName:"boHide",attribute:"hide"},{directiveName:"boClass",attribute:"class"},{directiveName:"boText",attribute:"text"},{directiveName:"boBind",attribute:"text"},{directiveName:"boHtml",attribute:"html"},{directiveName:"boSrcI",attribute:"src",interpolate:!0},{directiveName:"boSrc",attribute:"src"},{directiveName:"boHrefI",attribute:"href",interpolate:!0},{directiveName:"boHref",attribute:"href"},{directiveName:"boAlt",attribute:"alt"},{directiveName:"boTitle",attribute:"title"},{directiveName:"boId",attribute:"id"},{directiveName:"boStyle",attribute:"style"},{directiveName:"boDisabled",attribute:"disabled"},{directiveName:"boValue",attribute:"value"},{directiveName:"boAttr",attribute:"attr"},{directiveName:"boIf",transclude:"element",terminal:!0,priority:1e3},{directiveName:"boSwitch",require:"boSwitch",controller:function(){this.cases={}}},{directiveName:"boSwitchWhen",transclude:"element",priority:800,require:"^boSwitch"},{directiveName:"boSwitchDefault",transclude:"element",priority:800,require:"^boSwitch"}],function(b){var c=200;return a.directive(b.directiveName,function(){var a={priority:b.priority||c,transclude:b.transclude||!1,terminal:b.terminal||!1,require:["^bindonce"].concat(b.require||[]),controller:b.controller,compile:function(a,c,d){return function(a,c,e,f){var g=f[0],h=e.boParent;if(h&&g.group!==h){var i=g.element.parent();g=void 0;for(var j;9!==i[0].nodeType&&i.length;){if((j=i.data("$bindonceController"))&&j.group===h){g=j;break}i=i.parent()}if(!g)throw new Error("No bindonce controller: "+h)}g.addBinder({element:c,attr:b.attribute||b.directiveName,attrs:e,value:e[b.directiveName],interpolate:b.interpolate,group:h,transclude:d,controller:f.slice(1),scope:a})}}};return a})})}(),musicBrowserApp.directive("focusMe",["$timeout",function(a){return{scope:{trigger:"=focusMe"},link:function(a,b){a.$watch("trigger",function(c){c===!0&&(b[0].focus(),a.trigger=!1)})}}}]),musicBrowserControllers.controller("ModalCtrl",["$scope","$uibModalInstance","loadingMsg",function(a,b,c){a.loadingMsg=c}]),musicBrowserControllers.controller("SearchCtrl",["$rootScope","$scope","$location","mbCommon",function(a,b,c,d){b.searchTerm="",b.collection="artist",d.setPageTitle("Search"),d.isMobile()?b.shouldFocus=!1:b.shouldFocus=!0,b.missingInput=!0,b.submitQuery=function(){c.path("/search/"+b.collection+"/"+b.searchTerm),c.search("size="+d.getConfiguration().pageSize+"&offset=0")},b.submitForm=b.submitQuery,b.onSearchInputChange=function(){""===b.searchTerm?b.missingInput=!0:b.missingInput=!1},a.navCollapsed=!0,a.$on("$routeChangeSuccess",function(){a.navCollapsed=!0})}]),musicBrowserControllers.controller("ArtistSearchCtrl",["$scope","$routeParams","$location","mbData","mbCommon",function(a,b,c,d,e){e.setPageTitle("Artist Search - "+b.searchTerm),a.artists=[],a.searchTerm=b.searchTerm,a.pageSize=e.getConfiguration().pageSize,a.curPage=1,a.offset=0,d.isCached(c.url())||e.showLoadingDialog("Searching for artist ..."),a.setCurrentArtist=function(a){e.currentArtist=a},a.setCurrentGenre=function(a){e.currentGenre=a},d.searchForArtist(b.searchTerm,b.size,b.offset).then(function(c){var d,f;c.data?(a.artists=c.data,d=parseInt(b.offset),f=parseInt(b.size),0===d?a.curPage=1:a.curPage=d/f+1,a.offset=a.curPage*f):c.error?(a.msg=c.error,a.hasMessage=!0):a.noResults=!0,e.closeLoadingDialog(),a.ready=!0})}]),musicBrowserControllers.controller("ArtistLookupCtrl",["$scope","$routeParams","$location","$anchorScroll","mbData","mbCommon",function(a,b,c,d,e,f){f.setPageTitle("Artist - "+f.currentArtist),a.artist={},a.goBack=f.goBack,a.fullBioLink=c.absUrl()+"/full-bio",a.panes=[{title:"Discography",contentType:"Album",context:"ShortDiscog",content:"views/discogList.html",visible:!1,active:!0},{title:"Members",contentType:"Member",content:"views/artistMetaList.html",visible:!1,active:!1},{title:"Related Artists",contentType:"RelatedArtist",content:"views/artistMetaList.html",visible:!1,active:!1}],a.discogPanes=[{title:"Albums",contentType:"Album",active:!0},{title:"Compilations",contentType:"Compilation",active:!1},{title:"Singles & EPs",contentType:"SingleOrEP",active:!1}],a.setCurTab=function(a){sessionStorage.setItem("curTab",a+"|"+b.id)},a.setCurDiscogTab=function(a){sessionStorage.setItem("curDiscogTab",a+"|"+b.id)},a.setCurrentStyle=function(a){f.currentStyle=a},a.setCurrentAlbum=function(a){f.currentAlbum=a},a.doNavigation=function(){},a.discogSet=function(b){return b&&"ShortDiscog"===b?a.artist.shortDiscog:a.artist.discography};var g,h=c.hash(),i=c.url();e.isCached(i)||-1!==i.indexOf("full-bio")||-1!==i.indexOf("full-discog")||(g="Retrieving artist ...",f.showLoadingDialog(g)),a.showingFullDiscog=!1,i.indexOf("full-discog")>-1&&(a.showingFullDiscog=!0),e.lookupArtist(b.id).then(function(e){if(e.data){a.artist=e.data,a.artist.shortName=f.shorten(a.artist.name,15),a.artist.active&&(a.hasYears=!0),a.artist.birth.place&&(a.hasBirthplace=!0),a.artist.death.date&&(a.ended=!0),a.artist.headlineBioFormatted&&(a.hasHeadlineBio=!0),a.artist.shortDiscog.length>0&&(a.panes[0].visible=!0),a.artist.groupMembers&&(a.panes[1].visible=!0),a.artist.similars&&(a.panes[2].visible=!0),(a.panes[0].visible||a.panes[1].visible||a.panes[2].visible)&&(a.hasVisibleTabs=!0);var g,j,k;if(i.indexOf("full-discog")>-1?(j=sessionStorage.getItem("curDiscogTab"),k=a.discogPanes):(j=sessionStorage.getItem("curTab"),k=a.panes),j){g=j.split("|");for(var l=0;l<k.length;l++)k[l].title===g[0]&&b.id===g[1]?k[l].active=!0:k[l].active=!1}}else e.error?(a.msg=e.error,a.hasMessage=!0):a.noResults=!0;i.indexOf("full-discog")>-1&&(c.hash("discography"),d(),c.hash(h)),f.closeLoadingDialog(),a.ready=!0})}]),musicBrowserControllers.controller("AlbumSearchCtrl",["$scope","$routeParams","$location","mbData","mbCommon",function(a,b,c,d,e){e.setPageTitle("Album Search - "+b.searchTerm),a.albums=[],a.searchTerm=b.searchTerm,a.pageSize=e.getConfiguration().pageSize,a.curPage=1,a.offset=0,d.isCached(c.url())||e.showLoadingDialog("Searching for album ..."),a.setCurrentAlbum=function(a){e.currentAlbum=a},a.setCurrentArtist=function(a){e.currentArtist=a},d.searchForAlbum(b.searchTerm,b.size,b.offset).then(function(c){c.data?(a.albums=c.data,offsetVal=parseInt(b.offset),sizeVal=parseInt(b.size),0===offsetVal?a.curPage=1:a.curPage=offsetVal/sizeVal+1,a.offset=a.curPage*sizeVal):c.error?(a.msg=c.error,a.hasMessage=!0):a.noResults=!0,e.closeLoadingDialog(),a.ready=!0})}]),musicBrowserControllers.controller("AlbumLookupCtrl",["$scope","$routeParams","$location","mbData","mbCommon",function(a,b,c,d,e){e.setPageTitle("Album - "+e.currentAlbum),a.album={},a.goBack=e.goBack,a.fullReviewLink=c.absUrl()+"/full-review",a.hasReleaseDate=!1,a.hasDuration=!1,a.maxShortDescriptionLength=d.maxShortDescriptionLength;var f=c.url();d.isCached(f)||-1!==f.indexOf("full-review")||e.showLoadingDialog("Retrieving album ..."),a.setCurrentArtist=function(a){e.currentArtist=a},a.setCurrentStyle=function(a){e.currentStyle=a},d.lookupAlbum(b.id).then(function(b){b.data?(a.album=b.data,a.album.originalReleaseDate&&(a.hasReleaseDate=!0),a.album.durationFormatted&&(a.hasDuration=!0),a.album.headlineReviewFormatted&&(a.hasHeadlineReview=!0)):b.error?(a.msg=b.error,a.hasMessage=!0):a.noResults=!0,e.closeLoadingDialog(),a.ready=!0})}]),musicBrowserControllers.controller("SongSearchCtrl",["$scope","$routeParams","$location","mbData","mbCommon",function(a,b,c,d,e){e.setPageTitle("Song Search - "+b.searchTerm),a.songs=[],a.searchTerm=b.searchTerm,a.pageSize=e.getConfiguration().pageSize,a.curPage=1,a.offset=0,d.isCached(c.url())||e.showLoadingDialog("Searching for song ..."),d.searchForSong(b.searchTerm,b.size,b.offset).then(function(c){c.data?(a.songs=c.data,offsetVal=parseInt(b.offset),sizeVal=parseInt(b.size),0===offsetVal?a.curPage=1:a.curPage=offsetVal/sizeVal+1,a.offset=a.curPage*sizeVal):c.error?(a.msg=c.error,a.hasMessage=!0):a.noResults=!0,e.closeLoadingDialog(),a.ready=!0})}]),musicBrowserControllers.controller("StyleLookupCtrl",["$scope","$routeParams","$location","mbData","mbCommon",function(a,b,c,d,e){e.setPageTitle("Style - "+e.currentStyle),a.styles=[],a.goBack=e.goBack,d.isCached(c.url())||e.showLoadingDialog("Retrieving style ..."),d.lookupStyle(b.id).then(function(b){b.data?a.styles=b.data:b.error?(a.msg=b.error,a.hasMessage=!0):a.noResults=!0,e.closeLoadingDialog(),a.ready=!0})}]),musicBrowserControllers.controller("GenreLookupCtrl",["$scope","$routeParams","$location","mbData","mbCommon",function(a,b,c,d,e){e.setPageTitle("Genre - "+e.currentGenre),a.genres=[],a.goBack=e.goBack,d.isCached(c.url())||e.showLoadingDialog("Retrieving genre ..."),d.lookupGenre(b.id).then(function(b){b.data?a.genres=b.data:b.error?(a.msg=b.error,a.hasMessage=!0):a.noResults=!0,e.closeLoadingDialog(),a.ready=!0})}]),musicBrowserControllers.controller("OptionsCtrl",["$scope","$routeParams","mbCommon",function(a,b,c){a.albumChrono=!1,a.pageSize=20,a.hasMessage=!1,a.msg="";var d=c.getConfiguration();a.albumChrono=d.albumChrono,a.pageSize=d.pageSize,a.submitForm=function(){var b={};b.albumChrono=a.albumChrono,b.pageSize=a.pageSize,c.setConfiguration(b),a.msg="Settings saved",a.hasMessage=!0}}]);
//# sourceMappingURL=/sourceMap.map